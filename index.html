<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ultimate Biker Suite</title>
    <style>
        :root { --bg: #0a0a0a; --card: #1c1c1c; --accent: #ff4d00; --text: #eee; --green: #39ff14; }
        body { font-family: sans-serif; background: var(--bg); color: var(--text); margin: 0; display: flex; flex-direction: column; height: 100vh; overflow: hidden; }
        header { padding: 10px; text-align: center; border-bottom: 2px solid var(--accent); background: #000; }
        main { flex: 1; overflow-y: auto; padding-bottom: 70px; }
        .view { padding: 15px; }
        .hidden { display: none; }
        .card { background: var(--card); border-radius: 10px; padding: 15px; margin-bottom: 15px; border-left: 4px solid var(--accent); }
        input, select { width: 100%; padding: 10px; background: #333; border: 1px solid #444; color: white; border-radius: 5px; margin-top: 5px; box-sizing: border-box; }
        button { width: 100%; padding: 12px; border: none; border-radius: 5px; font-weight: bold; cursor: pointer; margin-top: 10px; background: var(--accent); color: white; }
        .progress { background: #333; height: 8px; border-radius: 4px; margin-top: 10px; }
        .progress-fill { background: var(--green); height: 100%; border-radius: 4px; width: 0%; transition: 0.5s; }
        .tab-bar { position: fixed; bottom: 0; width: 100%; display: flex; background: #000; padding: 10px 0; }
        .tab-bar button { background: none; flex: 1; margin: 0; font-size: 0.7rem; color: #888; }
        .tab-bar button.active { color: var(--accent); }
        .history-list { font-size: 0.8rem; margin-top: 10px; border-top: 1px solid #333; padding-top: 10px; }
        .gear-visual { display: flex; gap: 5px; height: 50px; align-items: flex-end; margin-top: 10px; }
        .gear-bar { background: var(--accent); flex: 1; text-align: center; font-size: 10px; }
    </style>
</head>
<body>

<header><h1 id="title">BIKER DASHBOARD</h1></header>

<main>
    <section id="dash" class="view">
        <div class="card">
            <h3>Wetter Live</h3>
            <button onclick="updateWeather()">Wetter aktualisieren</button>
            <p id="weather-desc">Klicke zum Laden...</p>
        </div>
        <div class="card">
            <h3>Service-Status</h3>
            <p id="km-info">Aktuell: 0 km / Ziel: 0 km</p>
            <div class="progress"><div id="service-bar" class="progress-fill"></div></div>
            <input type="number" id="input-km" placeholder="Aktueller km-Stand">
            <input type="number" id="input-next" placeholder="Service bei (km)">
            <button onclick="saveService()">Speichern</button>
        </div>
    </section>

    <section id="phys" class="view hidden">
        <div class="card">
            <h3>Schr√§glage: <span id="lean-val">0</span>¬∞</h3>
            <input type="range" min="10" max="150" value="50" oninput="calcPhys(this.value)">
            <div id="bike" style="font-size: 40px; text-align: center; transition: 0.3s;">üèçÔ∏è</div>
        </div>
        <div class="card">
            <h3>Gang-Visualisierer</h3>
            <p>V-Max pro Gang (Beispiel-Setup):</p>
            <div class="gear-visual" id="gear-container">
                <div class="gear-bar" style="height: 20%">1.</div>
                <div class="gear-bar" style="height: 40%">2.</div>
                <div class="gear-bar" style="height: 60%">3.</div>
                <div class="gear-bar" style="height: 80%">4.</div>
                <div class="gear-bar" style="height: 90%">5.</div>
                <div class="gear-bar" style="height: 100%">6.</div>
            </div>
        </div>
    </section>

    <section id="log" class="view hidden">
        <div class="card">
            <h3>Tankstopp eintragen</h3>
            <input type="number" id="fuel-km" placeholder="km-Stand">
            <input type="number" id="fuel-l" placeholder="Liter">
            <button onclick="saveFuel()">Eintragen</button>
            <div class="history-list" id="fuel-history">Keine Eintr√§ge</div>
        </div>
    </section>

    <section id="garage" class="view hidden">
        <div class="card">
            <h3>Mein Bike</h3>
            <input type="text" id="bike-name" placeholder="Modell (z.B. Z900)">
            <input type="date" id="bike-date" title="Kaufdatum">
            <button onclick="saveBike()">Bike-Daten speichern</button>
            <p id="bike-display"></p>
        </div>
        <div class="card">
            <h3>Ausr√ºstungs-Check</h3>
            <label><input type="checkbox" onchange="checkGear()"> Helm (Alter < 5J?)</label><br>
            <label><input type="checkbox" onchange="checkGear()"> Kette geschmiert?</label><br>
            <label><input type="checkbox" onchange="checkGear()"> Reifendruck okay?</label>
            <p id="gear-status" style="margin-top:10px"></p>
        </div>
    </section>
</main>

<nav class="tab-bar">
    <button onclick="show('dash', this)" class="active">Dash</button>
    <button onclick="show('phys', this)">Technik</button>
    <button onclick="show('log', this)">Log</button>
    <button onclick="show('garage', this)">Garage</button>
</nav>

<script>
    // Navigation
    function show(id, btn) {
        document.querySelectorAll('.view').forEach(v => v.classList.add('hidden'));
        document.querySelectorAll('.tab-bar button').forEach(b => b.classList.remove('active'));
        document.getElementById(id).classList.remove('hidden');
        btn.classList.add('active');
    }

    // 1. Wetter & Service
    async function updateWeather() {
        document.getElementById('weather-desc').innerText = "Lade...";
        // Nutzt √∂ffentliche API ohne Key f√ºr Demo (Geoloc)
        navigator.geolocation.getCurrentPosition(async p => {
            const res = await fetch(`https://api.open-meteo.com/v1/forecast?latitude=${p.coords.latitude}&longitude=${p.coords.longitude}&current_weather=true`);
            const data = await res.json();
            document.getElementById('weather-desc').innerText = `${data.current_weather.temperature}¬∞C - Wind: ${data.current_weather.windspeed}km/h`;
        });
    }

    function saveService() {
        const cur = document.getElementById('input-km').value;
        const next = document.getElementById('input-next').value;
        if(cur && next) {
            localStorage.setItem('service', JSON.stringify({cur, next}));
            renderService();
        }
    }

    function renderService() {
        const data = JSON.parse(localStorage.getItem('service') || '{"cur":0,"next":100}');
        const perc = Math.min((data.cur / data.next) * 100, 100);
        document.getElementById('km-info').innerText = `${data.cur} km / ${data.next} km`;
        document.getElementById('service-bar').style.width = perc + "%";
    }

    // 2. Physik
    function calcPhys(val) {
        document.getElementById('lean-val').innerText = Math.round(val / 3); // Vereinfacht
        document.getElementById('bike').style.transform = `rotate(${val/3}deg)`;
    }

    // 3. Tank-Historie
    function saveFuel() {
        const km = document.getElementById('fuel-km').value;
        const l = document.getElementById('fuel-l').value;
        let logs = JSON.parse(localStorage.getItem('fuelLogs') || '[]');
        logs.push({km, l, date: new Date().toLocaleDateString()});
        localStorage.setItem('fuelLogs', JSON.stringify(logs));
        renderFuel();
    }

    function renderFuel() {
        let logs = JSON.parse(localStorage.getItem('fuelLogs') || '[]');
        document.getElementById('fuel-history').innerHTML = logs.map(log => `<div>${log.date}: ${log.km}km - ${log.l}L</div>`).join('');
    }

    // 4. Garage
    function saveBike() {
        const name = document.getElementById('bike-name').value;
        localStorage.setItem('bikeName', name);
        renderBike();
    }

    function renderBike() {
        document.getElementById('bike-display').innerText = "Aktuelles Bike: " + (localStorage.getItem('bikeName') || "Keins");
    }

    function checkGear() {
        const count = document.querySelectorAll('input[type="checkbox"]:checked').length;
        document.getElementById('gear-status').innerText = count === 3 ? "‚úÖ Ready to Ride!" : "‚ùå Check unvollst√§ndig";
    }

    window.onload = () => { renderService(); renderFuel(); renderBike(); };
</script>
</body>
</html>
